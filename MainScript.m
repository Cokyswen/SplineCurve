% MAIN SCRIPT FILE

points = [
91.0  576.0;
90.0  577.0;
89.0  578.0;
88.0  579.0;
88.0  581.0;
88.0  584.0;
89.0  587.0;
90.0  590.0;
91.0  595.0;
93.0  600.0;
95.0  606.0;
97.0  613.0;
100.0  621.0;
103.0  631.0;
106.0  641.0;
110.0  652.0;
114.0  665.0;
119.0  679.0;
124.0  693.0;
130.0  707.0;
136.0  722.0;
144.0  737.0;
152.0  751.0;
161.0  763.0;
170.0  774.0;
179.0  783.0;
188.0  790.0;
197.0  794.0;
206.0  796.0;
215.0  795.0;
224.0  792.0;
232.0  787.0;
241.0  779.0;
249.0  770.0;
256.0  759.0;
263.0  746.0;
270.0  731.0;
275.0  714.0;
281.0  697.0;
285.0  679.0;
290.0  659.0;
294.0  639.0;
299.0  620.0;
303.0  601.0;
308.0  584.0;
312.0  569.0;
317.0  557.0;
322.0  546.0;
327.0  538.0;
331.0  533.0;
336.0  530.0;
341.0  530.0;
345.0  530.0;
349.0  533.0;
352.0  536.0;
356.0  541.0;
360.0  548.0;
364.0  556.0;
369.0  566.0;
373.0  577.0;
379.0  591.0;
385.0  606.0;
392.0  622.0;
399.0  638.0;
407.0  654.0;
415.0  669.0;
423.0  683.0;
431.0  694.0;
439.0  703.0;
447.0  710.0;
455.0  714.0;
463.0  717.0;
472.0  718.0;
481.0  718.0;
490.0  717.0;
500.0  714.0;
509.0  711.0;
518.0  706.0;
528.0  700.0;
537.0  694.0;
546.0  685.0;
555.0  676.0;
563.0  665.0;
570.0  653.0;
577.0  640.0;
583.0  626.0;
589.0  611.0;
593.0  595.0;
597.0  579.0;
601.0  563.0;
604.0  545.0;
606.0  528.0;
608.0  512.0;
610.0  495.0;
612.0  478.0;
614.0  464.0;
616.0  452.0;
618.0  441.0;
620.0  433.0;
622.0  427.0;
624.0  424.0;
626.0  422.0;
628.0  422.0;
630.0  423.0;
632.0  426.0;
634.0  431.0;
636.0  438.0;
639.0  447.0;
642.0  458.0;
646.0  472.0;
651.0  488.0;
656.0  507.0;
662.0  527.0;
668.0  548.0;
675.0  569.0;
683.0  590.0;
690.0  609.0;
698.0  627.0;
705.0  641.0;
712.0  653.0;
719.0  661.0;
726.0  666.0;
734.0  668.0;
741.0  669.0;
749.0  668.0;
757.0  665.0;
764.0  661.0;
772.0  655.0;
779.0  648.0;
786.0  640.0;
792.0  629.0;
797.0  617.0;
802.0  603.0;
807.0  588.0;
810.0  572.0;
813.0  554.0;
816.0  536.0;
819.0  518.0;
821.0  500.0;
824.0  481.0;
827.0  464.0;
830.0  449.0;
833.0  434.0;
836.0  421.0;
839.0  409.0;
842.0  399.0;
845.0  391.0;
848.0  383.0;
851.0  378.0;
854.0  374.0;
857.0  371.0;
860.0  371.0;
863.0  372.0;
867.0  376.0;
871.0  382.0;
877.0  390.0;
884.0  400.0;
891.0  412.0;
899.0  426.0;
907.0  442.0;
916.0  457.0;
925.0  472.0;
934.0  487.0;
943.0  502.0;
951.0  514.0;
959.0  526.0;
966.0  536.0;
973.0  544.0;
981.0  551.0;
988.0  557.0;
996.0  561.0;
1003.0  563.0;
1010.0  564.0;
1017.0  563.0;
1024.0  561.0;
1030.0  558.0;
1036.0  553.0;
1041.0  545.0;
1045.0  536.0;
1048.0  525.0;
1051.0  513.0;
1054.0  500.0;
1056.0  485.0;
1058.0  471.0;
1061.0  456.0;
1064.0  442.0;
1067.0  427.0;
1070.0  412.0;
1073.0  398.0;
1077.0  384.0;
1080.0  371.0;
1083.0  358.0;
1087.0  346.0;
1091.0  336.0;
1095.0  328.0;
1099.0  321.0;
1104.0  316.0;
1108.0  313.0;
1112.0  311.0;
1117.0  310.0;
1122.0  310.0;
1127.0  312.0;
1133.0  315.0;
1138.0  319.0;
1144.0  323.0;
1151.0  328.0;
1157.0  334.0;
1165.0  342.0;
1173.0  351.0;
1181.0  362.0;
1191.0  376.0;
1201.0  393.0;
1213.0  414.0;
1226.0  440.0;
1240.0  470.0;
1256.0  505.0;
1272.0  543.0;
1287.0  584.0;
1302.0  625.0;
];



C1 = CatmullRomSpline(0.5, 20, points);

alpha = 0.015;  % 平滑参数（邻域比例）
order = 2;    % 多项式阶数（1 表示线性）
y_smooth = Lowess(points, alpha, order);

smooth = [points(:, 1) y_smooth];
C2 = CatmullRomSpline(0.5, 20, smooth);

figure;
% points
plot(points(1:end, 1), points(1:end, 2), 'b.', 'MarkerSize', 10, 'marker', 'o');
hold on;
% Catmull-Rom-Spline
plot(C1(:,1), C1(:,2), 'color', 'g','LineWidth', 1, 'marker', 'o');
hold on;
% lowess
plot(points(:, 1), y_smooth, 'r', 'LineWidth', 1,  'marker', 'o');
hold on;
% lowess and Catmull-Rom-Spline
plot(C2(:,1), C2(:,2), 'color', 'k','LineWidth', 1, 'marker', '*');
hold on;
legend('True Point','CatmullRom', 'LOWESS ', 'LOWESS & CatmullRom');
xlabel('x');
ylabel('y');
title('LOWESS');
grid on;

%% Effects of different parameters for Catmull-Rom Spline
%C = CatmullRomSpline(0, 20, points);
%figure;
%plot(C(:,1), C(:,2), 'color', 'k','LineWidth', 2, 'marker', '*');
%hold on;
%C = CatmullRomSpline(0.5, 20, points);
%plot(C(:,1), C(:,2), 'color', 'm','LineWidth', 2, 'marker', '*');
%hold on;
%C = CatmullRomSpline(1, 20, points);
%plot(C(:,1), C(:,2), 'color', 'y','LineWidth', 2, 'marker', '*');
%hold on;
%plot(points(:, 1), points(:, 2), 'o', 'MarkerSize', 5);
%xlabel('x');
%ylabel('y');
%title('Alpha');
%grid on;

